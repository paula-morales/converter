{"ast":null,"code":"import { animate, style, transition, trigger } from '@angular/animations';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./homepage.service\";\nimport * as i2 from \"./block-currency/block-currency.component\";\nimport * as i3 from \"@angular/common\";\n\nfunction HomepageComponent_p_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 16);\n    i0.ɵɵtext(1, \" Loading... \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let HomepageComponent = /*#__PURE__*/(() => {\n  class HomepageComponent {\n    constructor(homepageService) {\n      this.homepageService = homepageService;\n    }\n\n    ngOnInit() {\n      this.initValues();\n      this.getRates();\n    }\n\n    initValues() {\n      this.sourceCurrency = 'USD';\n      this.sourceAmount = 1;\n      this.targetCurrency = 'EUR';\n    }\n\n    getRates() {\n      this.isLoading = true;\n      this.homepageService.getRatesByBase(this.sourceCurrency).subscribe(dataQuery => {\n        this.exchangeRate = dataQuery.data; //the source currency is not included in response of API so we add it\n\n        this.exchangeRate[this.sourceCurrency] = 1;\n        if (!this.allCurrencies) this.getAllCurrencies();\n        this.calculateTargetAmount();\n        this.stopLoading();\n      }, () => this.setErrorStatus());\n    }\n\n    getAllCurrencies() {\n      this.allCurrencies = Object.keys(this.exchangeRate).sort((a, b) => a.localeCompare(b));\n    }\n\n    calculateTargetAmount() {\n      if (this.rateExists()) {\n        const newTargetAmount = this.sourceAmount * this.exchangeRate[this.targetCurrency];\n        this.targetAmount = this.setFourDecimalPlaces(newTargetAmount);\n        this.setErrorMessage(false);\n      } else {\n        this.setErrorMessage(true);\n      }\n    }\n\n    rateExists() {\n      return this.exchangeRate[this.targetCurrency];\n    }\n\n    setFourDecimalPlaces(amount) {\n      return Number(amount.toFixed(4));\n    }\n\n    updateSourceCurrency(currencySelected) {\n      this.sourceCurrency = currencySelected;\n      this.getRates();\n    }\n\n    updateTargetCurrency(currencySelected) {\n      this.targetCurrency = currencySelected;\n      this.calculateTargetAmount();\n    }\n\n    updateSourceAmount(newSourceAmount) {\n      this.sourceAmount = newSourceAmount;\n      this.calculateTargetAmount();\n    }\n\n    calculateSourceAmount() {\n      if (this.rateExists()) {\n        const newSourceAmount = this.targetAmount / this.exchangeRate[this.targetCurrency];\n        this.sourceAmount = this.setFourDecimalPlaces(newSourceAmount);\n        this.setErrorMessage(false);\n      } else {\n        this.setErrorMessage(true);\n      }\n    }\n\n    updateTargetAmount(newTargetAmount) {\n      this.targetAmount = newTargetAmount;\n      this.calculateSourceAmount();\n    }\n\n    stopLoading() {\n      this.isLoading = false;\n      this.setErrorMessage(false);\n    }\n\n    setErrorStatus() {\n      this.isLoading = false;\n      this.setErrorMessage(true);\n    }\n\n    setErrorMessage(isError) {\n      this.errorMessage = isError ? 'Something went wrong' : '';\n    }\n\n  }\n\n  HomepageComponent.ɵfac = function HomepageComponent_Factory(t) {\n    return new (t || HomepageComponent)(i0.ɵɵdirectiveInject(i1.HomepageService));\n  };\n\n  HomepageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomepageComponent,\n    selectors: [[\"app-homepage\"]],\n    decls: 24,\n    vars: 12,\n    consts: [[1, \"homepage\", \"col-12\", \"px-0\", \"pt-md-5\", \"pt-2\", \"h-100\"], [1, \"homepage__title-wrapper\", \"col-md-6\", \"col-11\", \"mx-auto\"], [1, \"homepage__title\", \"text-uppercase\", \"text-center\"], [1, \"homepage__subtitle\", \"text-center\", \"mt-5\"], [1, \"homepage__currency-span\"], [1, \"homepage__currency-wrapper\", \"col-12\", \"px-0\", \"flex-wrap\", \"d-flex\", \"justify-content-between\", \"mt-4\"], [1, \"homepage__source-currency-wrapper\", \"col-4\", \"col-md-5\", \"px-0\"], [3, \"currency\", \"amount\", \"allCurrencies\", \"currencyChanged\", \"amountChanged\"], [\"aria-hidden\", \"true\", 1, \"homepage__symbol-converter\", \"col-2\", \"px-0\", \"d-flex\", \"justify-content-center\"], [1, \"homepage__symbol-converter-swap\", \"px-3\"], [1, \"homepage__target-currency-wrapper\", \"col-4\", \"col-md-5\", \"px-0\"], [1, \"homepage__messages\"], [\"class\", \"homepage__loading-message mt-3 text-center\", 4, \"ngIf\"], [1, \"homepage__error-message\", \"mt-3\", \"text-center\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"viewBox\", \"0 0 1440 320\"], [\"fill\", \"#0099ff\", \"fill-opacity\", \"0.9\", \"d\", \"M0,96L26.7,85.3C53.3,75,107,53,160,58.7C213.3,64,267,96,320,96C373.3,96,427,64,480,74.7C533.3,85,587,139,640,165.3C693.3,192,747,192,800,176C853.3,160,907,128,960,122.7C1013.3,117,1067,139,1120,149.3C1173.3,160,1227,160,1280,133.3C1333.3,107,1387,53,1413,26.7L1440,0L1440,320L1413.3,320C1386.7,320,1333,320,1280,320C1226.7,320,1173,320,1120,320C1066.7,320,1013,320,960,320C906.7,320,853,320,800,320C746.7,320,693,320,640,320C586.7,320,533,320,480,320C426.7,320,373,320,320,320C266.7,320,213,320,160,320C106.7,320,53,320,27,320L0,320Z\"], [1, \"homepage__loading-message\", \"mt-3\", \"text-center\"]],\n    template: function HomepageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"h1\", 2);\n        i0.ɵɵtext(3, \" Currency converter \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"h2\", 3);\n        i0.ɵɵelementStart(5, \"span\", 4);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(7, \" to \");\n        i0.ɵɵelementStart(8, \"span\", 4);\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 5);\n        i0.ɵɵelementStart(11, \"div\", 6);\n        i0.ɵɵelementStart(12, \"block-currency\", 7);\n        i0.ɵɵlistener(\"currencyChanged\", function HomepageComponent_Template_block_currency_currencyChanged_12_listener($event) {\n          return ctx.updateSourceCurrency($event);\n        })(\"amountChanged\", function HomepageComponent_Template_block_currency_amountChanged_12_listener($event) {\n          return ctx.updateSourceAmount($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 8);\n        i0.ɵɵelementStart(14, \"p\", 9);\n        i0.ɵɵtext(15, \"=\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 10);\n        i0.ɵɵelementStart(17, \"block-currency\", 7);\n        i0.ɵɵlistener(\"currencyChanged\", function HomepageComponent_Template_block_currency_currencyChanged_17_listener($event) {\n          return ctx.updateTargetCurrency($event);\n        })(\"amountChanged\", function HomepageComponent_Template_block_currency_amountChanged_17_listener($event) {\n          return ctx.updateTargetAmount($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"span\", 11);\n        i0.ɵɵtemplate(19, HomepageComponent_p_19_Template, 2, 0, \"p\", 12);\n        i0.ɵɵelementStart(20, \"p\", 13);\n        i0.ɵɵtext(21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(22, \"svg\", 14);\n        i0.ɵɵelement(23, \"path\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"@fadeIn\", ctx.sourceCurrency);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.sourceCurrency);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"@fadeIn\", ctx.targetCurrency);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.targetCurrency);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"currency\", ctx.sourceCurrency)(\"amount\", ctx.sourceAmount)(\"allCurrencies\", ctx.allCurrencies);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"currency\", ctx.targetCurrency)(\"amount\", ctx.targetAmount)(\"allCurrencies\", ctx.allCurrencies);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", ctx.errorMessage, \" \");\n      }\n    },\n    directives: [i2.BlockCurrencyComponent, i3.NgIf],\n    styles: [\".homepage__symbol-converter-swap[_ngcontent-%COMP%]{background-color:#09f;border-radius:2px;color:#fff;height:-moz-fit-content;height:fit-content;font-size:2rem}svg[_ngcontent-%COMP%]{position:absolute;bottom:0}.homepage__currency-wrapper[_ngcontent-%COMP%], .homepage__messages[_ngcontent-%COMP%]{position:relative;z-index:1}.homepage__subtitle[_ngcontent-%COMP%]{height:40px}\"],\n    data: {\n      animation: [trigger('fadeIn', [transition('*=>*', [style({\n        opacity: 0.7,\n        fontSize: '110%'\n      }), animate(500)])])]\n    }\n  });\n  return HomepageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}